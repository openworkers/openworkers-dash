<div>
  @if (database$ | async; as database) {
    <!-- Database Info -->
    <div class="card shadow-sm mt-8">
      <div class="inline-block p-4 w-full">
        <h4>Database Info</h4>
        <div class="mt-4">
          <label class="text-sm text-gray-500">Database ID</label>
          <div class="font-mono text-sm bg-gray-100 dark:bg-gray-800 p-2 rounded">{{ database.id }}</div>
        </div>
        <div class="mt-4">
          <label class="text-sm text-gray-500">Provider</label>
          <div class="text-sm">
            @if (database.provider === 'platform') {
              <span
                class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200"
              >
                Platform
              </span>
              <span class="text-gray-500 ml-2">Shared multi-tenant database</span>
            } @else {
              <span
                class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200"
              >
                PostgreSQL
              </span>
              <span class="text-gray-500 ml-2">Direct connection</span>
            }
          </div>
        </div>
        @if (database.desc) {
          <div class="mt-4">
            <label class="text-sm text-gray-500">Description</label>
            <div class="text-sm">{{ database.desc }}</div>
          </div>
        }
        <div class="mt-4 flex gap-4">
          <div>
            <label class="text-sm text-gray-500">Max Rows</label>
            <div class="text-sm">{{ database.maxRows }}</div>
          </div>
          <div>
            <label class="text-sm text-gray-500">Timeout</label>
            <div class="text-sm">{{ database.timeoutSeconds }}s</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Table Browser (Platform only) -->
    @if (database.provider === 'platform') {
      <div class="card shadow-sm mt-8">
        <div class="p-4">
          <h4 class="mb-4">Tables</h4>
          <app-table-browser [databaseId]="databaseId" [provider]="database.provider" />
        </div>
      </div>
    }

    <!-- Usage -->
    <div class="card shadow-sm mt-8">
      <div class="inline-block p-4 w-full">
        <h4>Usage</h4>
        <div class="mt-4">
          <p class="text-sm text-gray-600 dark:text-gray-400 mb-4">
            Once bound to your environment, you can query the database like this:
          </p>
          <pre
            class="text-xs bg-gray-100 dark:bg-gray-800 p-3 rounded block overflow-x-auto"
          ><code>// Query the database
const result = await env.DB.query(
  'SELECT * FROM users WHERE id = $1',
  [userId]
);

// Access results
console.log(result.rows);
console.log(result.rowCount);

// Insert data
await env.DB.query(
  'INSERT INTO users (name, email) VALUES ($1, $2)',
  ['John', 'john&#64;example.com']
);

// Create tables
await env.DB.query(`
  CREATE TABLE IF NOT EXISTS users (
    id SERIAL PRIMARY KEY,
    name TEXT NOT NULL,
    email TEXT UNIQUE
  )
`);</code></pre>
        </div>
      </div>
    </div>

    <app-debug [expand]="true">{{ database | json }}</app-debug>
  }
</div>
